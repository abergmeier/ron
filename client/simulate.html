<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>RON</title>
		<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
		<script type="text/javascript" src="mimic.js"></script>
		<script type="text/javascript">

			var _lastServerPosition = new Array(Number(0.000001), Number(0.000001));
		
			//* Start of simulation block
			//set the type of page

			function Simulation()
			{
				this.watches = new Array();
				var player1Positions = new Object();
				var positions = player1Positions;
				positions[0 * 1000] = new google.maps.LatLng(  53.088075,    8.808464);
				positions[3 * 1000] = new google.maps.LatLng(  53.088319,    8.809034);

				positions[4 * 1000] = new google.maps.LatLng(   53.088351,      8.809095);
				positions[5 * 1000] = new google.maps.LatLng(   53.088377,      8.809158);
				positions[6 * 1000] = new google.maps.LatLng(   53.088402,      8.809217);
				positions[7 * 1000] = new google.maps.LatLng(   53.088417,      8.809260);
				positions[8 * 1000] = new google.maps.LatLng(   53.088436,      8.809299);
				positions[9 * 1000] = new google.maps.LatLng(   53.088453,      8.809336);
				positions[10 * 1000] = new google.maps.LatLng(   53.088473,      8.809373);
				positions[11 * 1000] = new google.maps.LatLng(   53.088492,      8.809417);
				positions[12 * 1000] = new google.maps.LatLng(   53.088513,      8.809459);
				positions[13 * 1000] = new google.maps.LatLng(   53.088535,      8.809492);
				positions[14 * 1000] = new google.maps.LatLng(   53.088553,      8.809536);
				positions[15 * 1000] = new google.maps.LatLng(    53.088578,      8.809583);

				positions[16 * 1000] = new google.maps.LatLng(  53.088606,    8.809649);
				positions[17 * 1000] = new google.maps.LatLng(  53.088850,    8.810189);

				positions[18 * 1000] = new google.maps.LatLng(  53.089095,    8.810706); //WP1

				positions[19 * 1000] = new google.maps.LatLng(  53.089389,    8.810377);
				positions[19.5 * 1000] = new google.maps.LatLng(  53.089744,   8.810011);

				positions[20.0 * 1000] = new google.maps.LatLng(  53.089977,   8.809746); //WP2

				positions[20.5 * 1000] = new google.maps.LatLng(  53.090206,   8.809430);
				positions[21.0 * 1000] = new google.maps.LatLng(  53.090504,   8.809104);
				positions[21.5 * 1000] = new google.maps.LatLng(  53.090694,   8.808931);
				positions[22.0 * 1000] = new google.maps.LatLng(  53.090871,   8.809308);

				positions[22.5 * 1000] = new google.maps.LatLng(  53.091030,   8.809687); //WP3

				positions[23.0 * 1000] = new google.maps.LatLng(  53.091215,   8.809465);
				positions[23.5 * 1000] = new google.maps.LatLng(  53.091418,   8.809213);
				positions[24.0 * 1000] = new google.maps.LatLng(  53.091628,   8.808975);
				positions[24.5 * 1000] = new google.maps.LatLng(  53.091809,   8.808752);
				positions[25.0 * 1000] = new google.maps.LatLng(  53.091952,   8.808569);

				positions[25.5 * 1000] = new google.maps.LatLng(  53.092079,   8.808450); //WP4

				positions[26.0 * 1000] = new google.maps.LatLng(  53.092167,   8.808628);
				positions[26.5 * 1000] = new google.maps.LatLng(  53.092328,   8.809002);
				positions[27.0 * 1000] = new google.maps.LatLng(  53.092475,   8.808844);
				positions[27.5 * 1000] = new google.maps.LatLng(  53.092606,   8.808669);
				positions[28.0 * 1000] = new google.maps.LatLng(  53.092747,   8.808493);

				positions[28.5 * 1000] = new google.maps.LatLng(  53.092908,   8.808303); //WP5

				positions[29.0 * 1000] = new google.maps.LatLng(  53.093015,   8.808180);
				positions[29.5 * 1000] = new google.maps.LatLng(  53.093124,   8.808055);
				positions[30.0 * 1000] = new google.maps.LatLng(  53.093216,   8.807949);
				positions[30.5 * 1000] = new google.maps.LatLng(  53.093348,   8.807810);
				positions[31.0 * 1000] = new google.maps.LatLng(  53.093473,   8.807664);
				positions[31.5 * 1000] = new google.maps.LatLng(  53.093573,   8.807560);

				positions[32.0 * 1000] = new google.maps.LatLng(  53.093644,   8.807492); //WP6

				positions[32.5 * 1000] = new google.maps.LatLng(  53.093760,   8.807338);
				positions[33.0 * 1000] = new google.maps.LatLng(  53.093910,   8.807188);
				positions[33.5 * 1000] = new google.maps.LatLng(  53.094052,   8.807050); 
				positions[34.0 * 1000] = new google.maps.LatLng(  53.094189,   8.806969);
				positions[34.5 * 1000] = new google.maps.LatLng(  53.094255,   8.807182);

				positions[35.0 * 1000] = new google.maps.LatLng(  53.094286,   8.807383); //WP7

				positions[35.5 * 1000] = new google.maps.LatLng(  53.094376,   8.807506);
				positions[36.0 * 1000] = new google.maps.LatLng(  53.094477,   8.807637);

				positions[36.5 * 1000] = new google.maps.LatLng(  53.094561,   8.807750); //WP8

				positions[37.0 * 1000] = new google.maps.LatLng(  53.094650,   8.807865);
				positions[37.5 * 1000] = new google.maps.LatLng(  53.094747,   8.808004);

				positions[38.0 * 1000] = new google.maps.LatLng(  53.094853,   8.808150); //WP9 //COLLISION SPIELER 2 DEFEAT

				positions[38.5 * 1000] = new google.maps.LatLng(  53.094933,   8.807986);
				positions[39.0 * 1000] = new google.maps.LatLng(  53.095024,   8.807805);
				positions[39.5 * 1000] = new google.maps.LatLng(  53.095107,   8.807631);

				positions[40.0 * 1000] = new google.maps.LatLng(  53.095194,   8.807476); //WP10

				positions[40.5 * 1000] = new google.maps.LatLng(  53.095298,   8.807294);
				positions[39.4 * 1000] = new google.maps.LatLng(  53.095395,   8.807132); //COLLISION + DEFEAT


				/************************
				*	SPIELER 2	*
				*			*
				************************/
				var player2Positions = new Object();
				positions = player2Positions;
				positions[0 * 1000] = new google.maps.LatLng(   53.094717,       8.797023);
				positions[3 * 1000] = new google.maps.LatLng(   53.094687,       8.797604);

				positions[4 * 1000] = new google.maps.LatLng(    53.094689,         8.797705);
				positions[5 * 1000] = new google.maps.LatLng(    53.094683,         8.797796);
				positions[6 * 1000] = new google.maps.LatLng(    53.094680,         8.797856);
				positions[7 * 1000] = new google.maps.LatLng(    53.094678,         8.797919);
				positions[8 * 1000] = new google.maps.LatLng(    53.094672,         8.797996);
				positions[9 * 1000] = new google.maps.LatLng(    53.094668,         8.798068);
				positions[10 * 1000] = new google.maps.LatLng(    53.094664,         8.798147);
				positions[11* 1000] = new google.maps.LatLng(    53.094661,         8.798223);
				positions[12 * 1000] = new google.maps.LatLng(    53.094659,         8.798261);




				positions[13 * 1000] = new google.maps.LatLng(   53.094653,       8.798298);
				positions[14 * 1000] = new google.maps.LatLng(   53.094630,       8.798817);
				positions[15 * 1000] = new google.maps.LatLng(   53.094596,       8.799319);

				positions[16 * 1000] = new google.maps.LatLng(   53.094617,       8.799633); //WP1

				positions[17 * 1000] = new google.maps.LatLng(   53.094603,     8.800047);
				positions[18 * 1000] = new google.maps.LatLng(   53.094566,     8.800481);
				positions[19 * 1000] = new google.maps.LatLng(   53.094536,     8.800908);

				positions[21.0 * 1000] = new google.maps.LatLng(   53.094539,     8.801290); //WP2

				positions[21.5 * 1000] = new google.maps.LatLng(   53.094340,     8.801306);
				positions[22.0 * 1000] = new google.maps.LatLng(   53.094080,     8.801273);
				positions[22.5 * 1000] = new google.maps.LatLng(   53.093843,     8.801268);
				positions[23.0 * 1000] = new google.maps.LatLng(   53.093581,     8.801274);
				positions[23.5 * 1000] = new google.maps.LatLng(   53.093360,     8.801482);
				positions[24.0 * 1000] = new google.maps.LatLng(   53.093197,     8.801701);

				positions[24.5 * 1000] = new google.maps.LatLng(   53.092974,     8.802028); //WP3

				positions[25.0 * 1000] = new google.maps.LatLng(   53.092744,     8.802313);

				positions[25.5 * 1000] = new google.maps.LatLng(   53.092490,     8.802655); //WP4

				positions[26.0 * 1000] = new google.maps.LatLng(   53.092559,     8.802930);
				positions[26.5 * 1000] = new google.maps.LatLng(   53.092378,     8.803169);
				positions[27.0 * 1000] = new google.maps.LatLng(   53.092232,     8.803320);
				positions[27.2 * 1000] = new google.maps.LatLng(   53.092059,     8.803473);
				positions[27.4 * 1000] = new google.maps.LatLng(   53.091915,     8.803618);

				positions[27.8 * 1000] = new google.maps.LatLng(   53.091822,     8.803700); //WP5

				positions[28.0 * 1000] = new google.maps.LatLng(   53.091699,     8.803818);
				positions[28.2 * 1000] = new google.maps.LatLng(   53.091565,     8.803968);
				positions[28.4 * 1000] = new google.maps.LatLng(   53.091636,     8.804243);
				positions[28.6 * 1000] = new google.maps.LatLng(   53.091757,     8.804532);
				positions[28.8 * 1000] = new google.maps.LatLng(   53.091887,     8.804768);
				positions[29.0 * 1000] = new google.maps.LatLng(   53.091980,     8.805036);
				positions[29.2 * 1000] = new google.maps.LatLng(   53.092110,     8.805419);
				positions[29.5 * 1000] = new google.maps.LatLng(   53.092231,     8.805644);
				positions[30.0 * 1000] = new google.maps.LatLng(   53.092375,     8.805959);
				positions[30.5 * 1000] = new google.maps.LatLng(   53.092522,     8.806257);

				positions[31.0 * 1000] = new google.maps.LatLng(   53.092693,     8.806609);
				positions[31.5 * 1000] = new google.maps.LatLng(   53.092869,     8.807005);
				positions[32.6 * 1000] = new google.maps.LatLng(   53.093059,     8.807399);
				positions[32.8 * 1000] = new google.maps.LatLng(   53.093238,     8.807213);
				positions[33.0 * 1000] = new google.maps.LatLng(   53.093438,     8.806991);
				positions[33.2 * 1000] = new google.maps.LatLng(   53.093611,     8.806814);
				positions[33.4 * 1000] = new google.maps.LatLng(   53.093799,     8.806614);

				positions[33.6 * 1000] = new google.maps.LatLng(   53.093977,     8.806468); //WP6

				positions[33.8 * 1000] = new google.maps.LatLng(   53.094083,     8.806459);
				positions[33.9 * 1000] = new google.maps.LatLng(   53.094142,     8.806758);
				positions[34.0 * 1000] = new google.maps.LatLng(   53.094288,     8.807012);
				positions[34.1 * 1000] = new google.maps.LatLng(   53.094422,     8.807181);
				positions[34.3 * 1000] = new google.maps.LatLng(   53.094460,     8.806760);

				positions[34.5 * 1000] = new google.maps.LatLng(   53.094453,     8.806339); //WP7

				positions[35.0 * 1000] = new google.maps.LatLng(   53.094451,     8.805960);
				positions[35.2 * 1000] = new google.maps.LatLng(   53.094463,     8.805555);
				positions[35.5 * 1000] = new google.maps.LatLng(   53.094485,     8.805131);
				positions[36.0 * 1000] = new google.maps.LatLng(   53.094512,     8.804515);
				positions[36.5 * 1000] = new google.maps.LatLng(   53.094545,     8.804127);
				positions[37.0 * 1000] = new google.maps.LatLng(   53.094550,     8.803789);

				positions[37.2 * 1000] = new google.maps.LatLng(   53.094559,     8.803502); //WP8

				positions[37.4 * 1000] = new google.maps.LatLng(   53.094714,     8.803497);
				positions[37.6 * 1000] = new google.maps.LatLng(   53.094967,     8.803584);
				positions[37.8 * 1000] = new google.maps.LatLng(   53.095188,     8.803849);
				positions[38.0 * 1000] = new google.maps.LatLng(   53.095420,     8.804123);
				positions[38.5 * 1000] = new google.maps.LatLng(   53.095591,     8.804380);

				positions[39.0 * 1000] = new google.maps.LatLng(   53.095733,     8.804501); //WP9

				positions[39.2 * 1000] = new google.maps.LatLng(   53.095872,     8.804159);
				positions[39.5 * 1000] = new google.maps.LatLng(   53.096012,     8.803891);
				positions[40.0 * 1000] = new google.maps.LatLng(   53.096195,     8.804107);
				positions[41.0 * 1000] = new google.maps.LatLng(   53.096367,     8.804349);

				positions[41.5 * 1000] = new google.maps.LatLng(   53.096534,     8.804530); //WP10

				positions[42.0 * 1000] = new google.maps.LatLng(   53.096758,     8.804763);
				positions[42.5 * 1000] = new google.maps.LatLng(   53.097000,     8.805045);

				positions[43.0 * 1000] = new google.maps.LatLng(   53.097183,     8.805224); //WP11

				positions[43.5 * 1000] = new google.maps.LatLng(   53.097321,     8.804810);
				positions[44.0 * 1000] = new google.maps.LatLng(   53.097428,     8.804446);

				positions[44.2 * 1000] = new google.maps.LatLng(   53.097547,     8.804098); //WP12

				positions[44.5 * 1000] = new google.maps.LatLng(   53.097670,     8.803686);
				positions[45.0 * 1000] = new google.maps.LatLng(   53.097804,     8.803311);

				positions[45.2 * 1000] = new google.maps.LatLng(   53.097894,     8.802991); //WP13

				positions[45.5 * 1000] = new google.maps.LatLng(   53.098079,     8.803168);
				positions[46.0 * 1000] = new google.maps.LatLng(   53.098301,     8.803416);
				positions[46.5 * 1000] = new google.maps.LatLng(   53.098562,     8.803642);

				positions[47.0 * 1000] = new google.maps.LatLng(   53.098757,     8.803826); //WP 14

				positions[47.5 * 1000] = new google.maps.LatLng(   53.099013,     8.803724);

				positions[48.5 * 1000] = new google.maps.LatLng(   53.099292,     8.803580);
				positions[49.0 * 1000] = new google.maps.LatLng(   53.099484,     8.803682);

				positions[49.5 * 1000] = new google.maps.LatLng(   53.099633,     8.803877); //WP15

				positions[50.0 * 1000] = new google.maps.LatLng(   53.099675,     8.804120);
				positions[51.5 * 1000] = new google.maps.LatLng(   53.099731,     8.804410);
				positions[52.5 * 1000] = new google.maps.LatLng(   53.099879,     8.804551); 
				positions[53.0 * 1000] = new google.maps.LatLng(   53.100057,     8.804662);

				positions[53.5 * 1000] = new google.maps.LatLng(   53.100210,     8.804834); //WP16

				positions[54.0 * 1000] = new google.maps.LatLng(   53.100340,     8.805465);
				positions[54.5 * 1000] = new google.maps.LatLng(   53.100214,     8.805884);

				positions[55.5 * 1000] = new google.maps.LatLng(   53.100109,     8.806405); //WP17

				positions[56.0 * 1000] = new google.maps.LatLng(   53.099909,     8.807147); 
				positions[56.5 * 1000] = new google.maps.LatLng(   53.099745,     8.807514);
				positions[57.0 * 1000] = new google.maps.LatLng(   53.099604,     8.808039);
				positions[58.0 * 1000] = new google.maps.LatLng(   53.099538,     8.808274); 

				positions[58.5 * 1000] = new google.maps.LatLng(   53.099402,     8.808720); //WP18

				positions[59.0 * 1000] = new google.maps.LatLng(   53.099190,     8.809313);

				positions[59.5 * 1000] = new google.maps.LatLng(   53.098926,     8.809205); //WP19

				positions[60.0 * 1000] = new google.maps.LatLng(   53.098685,     8.809043);

				positions[61.5 * 1000] = new google.maps.LatLng(   53.098390,     8.808905); //WP20
				positions[62.0 * 1000] = new google.maps.LatLng(   53.098013,     8.809077); //WP21

				positions[63.5 * 1000] = new google.maps.LatLng(   53.097992,     8.809338);

				positions[64.0 * 1000] = new google.maps.LatLng(   53.098126,     8.809439); //WP22

				positions[64.5 * 1000] = new google.maps.LatLng(   53.098277,     8.809431);
				positions[65.0 * 1000] = new google.maps.LatLng(   53.098395,     8.809465);

				positions[65.5 * 1000] = new google.maps.LatLng(   53.098477,     8.809507); //WP23

				positions[66.0 * 1000] = new google.maps.LatLng(   53.098570,     8.809329);
				positions[66.5 * 1000] = new google.maps.LatLng(   53.098718,     8.809191);
				positions[67.0 * 1000] = new google.maps.LatLng(    53.098918,       8.809094); //COLLISION + DEFEAT


				/************************
				*	SPIELER 3	*
				*			*
				************************/
				var player3Positions = new Object();
				positions = player3Positions;
				positions[0 * 1000] = new google.maps.LatLng(  53.095531,     8.818193);
				positions[3 * 1000] = new google.maps.LatLng(  53.095318,     8.817900);

				positions[4 * 1000] = new google.maps.LatLng(    53.095247,         8.817811);
				positions[5 * 1000] = new google.maps.LatLng(    53.095150,         8.817678);
				positions[6 * 1000] = new google.maps.LatLng(    53.095074,         8.817576);

				positions[7 * 1000] = new google.maps.LatLng(  53.095012,     8.817504);

				positions[8 * 1000] = new google.maps.LatLng(    53.094986,         8.817461);
				positions[9 * 1000] = new google.maps.LatLng(    53.094951,         8.817421);
				positions[10 * 1000] = new google.maps.LatLng(    53.094918,         8.817374);
				positions[11 * 1000] = new google.maps.LatLng(    53.094885,        8.817326);
				positions[12 * 1000] = new google.maps.LatLng(    53.094859,         8.817296);
				positions[13 * 1000] = new google.maps.LatLng(    53.094830,         8.817252);
				positions[14 * 1000] = new google.maps.LatLng(    53.094797,         8.817204);

				positions[15.0 * 1000] = new google.maps.LatLng(  53.094760,     8.817162); //WP1

				positions[16.0 * 1000] = new google.maps.LatLng(  53.094614,     8.816875);
				positions[17.0 * 1000] = new google.maps.LatLng(  53.094399,     8.816495);
				positions[18.0 * 1000] = new google.maps.LatLng(  53.094234,    8.816139);
				positions[19.0 * 1000] = new google.maps.LatLng(  53.094239,    8.815681);
				positions[20.0 * 1000] = new google.maps.LatLng(  53.094468,    8.815388);
				positions[21.0 * 1000] = new google.maps.LatLng(  53.094654,    8.815112);

				positions[21.0 * 1000] = new google.maps.LatLng(  53.094775,    8.814955); //WP2

				positions[22.0 * 1000] = new google.maps.LatLng(  53.094905,    8.814784);
				positions[22.5 * 1000] = new google.maps.LatLng(  53.095128,    8.814510);
				positions[23.0 * 1000] = new google.maps.LatLng(  53.095412,    8.814151);
				positions[23.5 * 1000] = new google.maps.LatLng(  53.095696,    8.813789);
				positions[24.0 * 1000] = new google.maps.LatLng(  53.095908,    8.813546);

				positions[24.5 * 1000] = new google.maps.LatLng(  53.096064,    8.813392); //WP3

				positions[25.0 * 1000] = new google.maps.LatLng(  53.095978,    8.813085);
				positions[25.5 * 1000] = new google.maps.LatLng(  53.095868,    8.812746);
				positions[26.0 * 1000] = new google.maps.LatLng(  53.095789,    8.812497);

				positions[26.5 * 1000] = new google.maps.LatLng(  53.095714,    8.812261); //WP4

				positions[27.0 * 1000] = new google.maps.LatLng(  53.095867,    8.812010);
				positions[27.5 * 1000] = new google.maps.LatLng(  53.096025,    8.811791);
				positions[28.0 * 1000] = new google.maps.LatLng(  53.096239,    8.811493);
				positions[28.5 * 1000] = new google.maps.LatLng(  53.096402,    8.811252);

				positions[29.0 * 1000] = new google.maps.LatLng(  53.096534,    8.811074); //WP5

				positions[29.5 * 1000] = new google.maps.LatLng(  53.096372,    8.810844);
				positions[30.0 * 1000] = new google.maps.LatLng(  53.096133,    8.810503);
				positions[30.5 * 1000] = new google.maps.LatLng(  53.095966,    8.810254);

				positions[31.0 * 1000] = new google.maps.LatLng(  53.095752,    8.809983); //WP6

				positions[31.5 * 1000] = new google.maps.LatLng(  53.095569,    8.809874);
				positions[32.0 * 1000] = new google.maps.LatLng(  53.095334,    8.809716);
				positions[33.5 * 1000] = new google.maps.LatLng(  53.095210,    8.809433);
				positions[34.0 * 1000] = new google.maps.LatLng(  53.095099,    8.809137);
				positions[35.5 * 1000] = new google.maps.LatLng(  53.094955,    8.809051);
				positions[36.0 * 1000] = new google.maps.LatLng(  53.094882,    8.808804);

				positions[37.5 * 1000] = new google.maps.LatLng(  53.094776,    8.808487); //WP7

				positions[38.1 * 1000] = new google.maps.LatLng(  53.094778,    8.808237);
				positions[38.4 * 1000] = new google.maps.LatLng(  53.094771,    8.808007); //COLLISION + DEFEAT



				/************************
				*	SPIELER 4	*
				*			*
				************************/
				var player4Positions = new Object();
				positions = player4Positions;
				positions[0 * 1000] = new google.maps.LatLng(  53.100090,    8.805098);
				positions[3 * 1000] = new google.maps.LatLng(  53.099832,    8.804868);


				positions[4 * 1000] = new google.maps.LatLng(    53.099766,         8.804810);
				positions[5 * 1000] = new google.maps.LatLng(    53.099682,         8.804732);
				positions[6 * 1000] = new google.maps.LatLng(    53.099602,         8.804663);

				positions[7 * 1000] = new google.maps.LatLng(  53.099535,    8.804615);

				positions[8 * 1000] = new google.maps.LatLng(    53.099513,         8.804588);
				positions[9 * 1000] = new google.maps.LatLng(    53.099490,         8.804568);
				positions[10.0 * 1000] = new google.maps.LatLng(   553.099461,         8.804538);
				positions[11.0 * 1000] = new google.maps.LatLng(    53.099438,         8.804516);
				positions[12.0 * 1000] = new google.maps.LatLng(    53.099408,         8.804493);
				positions[13.0 * 1000] = new google.maps.LatLng(    53.099377,         8.804465);
				positions[14.0 * 1000] = new google.maps.LatLng(    53.099353,        8.804443);


				positions[15 * 1000] = new google.maps.LatLng(    53.099322,   8.804435); //WP1

				positions[16.0 * 1000] = new google.maps.LatLng(  53.099147,    8.804212);
				positions[17.0 * 1000] = new google.maps.LatLng(  53.098946,    8.803987);
				positions[18.0 * 1000] = new google.maps.LatLng(  53.098745,    8.804029);
				positions[19.0 * 1000] = new google.maps.LatLng(  53.098646,    8.804315);

				positions[21.0 * 1000] = new google.maps.LatLng(  53.098559,    8.804607); //WP2

				positions[22.0 * 1000] = new google.maps.LatLng(  53.098454,    8.804812);
				positions[22.5 * 1000] = new google.maps.LatLng(  53.098358,    8.805114);
				positions[23.0 * 1000] = new google.maps.LatLng(  53.098266,    8.805415);
				positions[23.5 * 1000] = new google.maps.LatLng(  53.098189,    8.805625);

				positions[24.0 * 1000] = new google.maps.LatLng(  53.098144,    8.805810); //WP3

				positions[24.5 * 1000] = new google.maps.LatLng(  53.098056,    8.806056);
				positions[25.0 * 1000] = new google.maps.LatLng(  53.097970,    8.806311);
				positions[25.5 * 1000] = new google.maps.LatLng(  53.097893,    8.806607);
				positions[26.0 * 1000] = new google.maps.LatLng(  53.097867,    8.806924);
				positions[26.5 * 1000] = new google.maps.LatLng(  53.097690,    8.807059);
				positions[27.0 * 1000] = new google.maps.LatLng(  53.097514,    8.807037);

				positions[27.5 * 1000] = new google.maps.LatLng(  53.097351,    8.807011); //WP4

				positions[28.0 * 1000] = new google.maps.LatLng(  53.097205,    8.806971);
				positions[28.5 * 1000] = new google.maps.LatLng(  53.097009,    8.806919);
				positions[29.0 * 1000] = new google.maps.LatLng(  53.096757,    8.806807);

				positions[29.5 * 1000] = new google.maps.LatLng(  53.096610,    8.806733); //WP5

				positions[30.0 * 1000] = new google.maps.LatLng(  53.096669,    8.806472);
				positions[30.5 * 1000] = new google.maps.LatLng(  53.096504,    8.806291);
				positions[31.0 * 1000] = new google.maps.LatLng(  53.096334,    8.806088);
				positions[31.5 * 1000] = new google.maps.LatLng(  53.096170,    8.805903);

				positions[32.0 * 1000] = new google.maps.LatLng(  53.096016,    8.805751); //WP6

				positions[32.5 * 1000] = new google.maps.LatLng(  53.095870,    8.805588);
				positions[33.0 * 1000] = new google.maps.LatLng(  53.095702,    8.805391);

				positions[33.5 * 1000] = new google.maps.LatLng(  53.095499,    8.805171);
				positions[34.0 * 1000] = new google.maps.LatLng(  53.095368,    8.805422);

				positions[34.5 * 1000] = new google.maps.LatLng(  53.095225,    8.805725); //WP7

				positions[35.0 * 1000] = new google.maps.LatLng(  53.095162,    8.805924);
				positions[35.5 * 1000] = new google.maps.LatLng(  53.095057,    8.806205);
				positions[36.0 * 1000] = new google.maps.LatLng(  53.094980,    8.806436); 

				positions[36.5 * 1000] = new google.maps.LatLng(  53.094912,    8.806638); //WP8

				positions[37.0 * 1000] = new google.maps.LatLng(  53.095061,    8.806775);

				positions[37.5 * 1000] = new google.maps.LatLng(  53.095200,    8.806935); //WP9

				positions[38.0 * 1000] = new google.maps.LatLng(  53.095357,    8.807086);

				positions[38.5 * 1000] = new google.maps.LatLng(  53.095568,    8.807319); //WP10 //COLLISION WITH PLAYER 01!

				positions[40.5 * 1000] = new google.maps.LatLng(  53.095624,   8.807538);
				positions[42.5 * 1000] = new google.maps.LatLng(  53.095644,   8.807782);
				positions[43.0 * 1000] = new google.maps.LatLng(  53.095684,   8.807967);
				positions[44.5 * 1000] = new google.maps.LatLng(  53.095670,   8.808235);
				positions[45.0 * 1000] = new google.maps.LatLng(  53.095716,   8.808479);

				positions[46.5 * 1000] = new google.maps.LatLng(  53.095782,   8.808741); //WP11

				positions[47.0 * 1000] = new google.maps.LatLng(  53.095929,   8.808731);
				positions[48.5 * 1000] = new google.maps.LatLng(  53.096045,   8.808714);

				positions[49.0 * 1000] = new google.maps.LatLng(  53.096169,   8.808689); //WP12

				positions[50.5 * 1000] = new google.maps.LatLng(  53.096271,   8.808648);

				positions[51.0 * 1000] = new google.maps.LatLng(  53.096375,   8.808554); //WP13

				positions[52.5 * 1000] = new google.maps.LatLng(  53.096444,   8.808642);
				positions[53.0 * 1000] = new google.maps.LatLng(  53.096523,   8.808699);
				positions[53.5 * 1000] = new google.maps.LatLng(  53.096607,   8.808685);
				positions[54.0 * 1000] = new google.maps.LatLng(  53.096680,   8.808672);
				positions[54.5 * 1000] = new google.maps.LatLng(  53.096761,   8.808673);
				positions[55.0 * 1000] = new google.maps.LatLng(  53.096843,   8.808668);

				positions[55.5 * 1000] = new google.maps.LatLng(  53.096924,   8.808665); //WP14

				positions[56.0 * 1000] = new google.maps.LatLng(  53.097082,   8.808678);
				positions[56.5 * 1000] = new google.maps.LatLng(  53.097240,   8.808692);
				positions[57.0 * 1000] = new google.maps.LatLng(  53.097405,   8.808772);

				positions[58.5 * 1000] = new google.maps.LatLng(  53.097614,   8.808802); //WP15

				positions[59.0 * 1000] = new google.maps.LatLng(  53.097733,   8.808939);
				positions[60.5 * 1000] = new google.maps.LatLng(  53.097708,   8.809244);

				positions[62.0 * 1000] = new google.maps.LatLng(  53.097663,   8.809479); //WP16

				positions[63.5 * 1000] = new google.maps.LatLng(  53.097638,   8.809781);
				positions[64.0 * 1000] = new google.maps.LatLng(  53.097789,   8.809822);

				positions[64.5 * 1000] = new google.maps.LatLng(  53.097935,   8.809845); //WP17

				positions[65.0 * 1000] = new google.maps.LatLng(  53.098130,   8.809870);

				positions[65.5 * 1000] = new google.maps.LatLng(  53.098301,   8.809895); //WP18

				positions[66.0 * 1000] = new google.maps.LatLng(  53.098472,   8.809879);

				positions[66.5 * 1000] = new google.maps.LatLng(  53.098623,   8.809432); //WP19
				positions[67.0 * 1000] = new google.maps.LatLng(  53.098902,   8.809358); //WP20

				positions[67.5 * 1000] = new google.maps.LatLng(  53.099142,   8.809131); //VICTORY!

				this._playerPositions = new Array
				(
					player1Positions,
					player2Positions,
					player3Positions,
					player4Positions
				);

				var player1Nodes = new Object();
				var nodes = player1Nodes;
				nodes[18 * 1000] = true;
				nodes[20.0 * 1000] = true;
				nodes[22.5 * 1000] = true;
				nodes[25.5 * 1000] = true;
				nodes[28.5 * 1000] = true;
				nodes[32.0 * 1000] = true;
				nodes[35.0 * 1000] = true;
				nodes[38.5 * 1000] = true;
				nodes[40.0 * 1000] = true;

				var player2Nodes = new Object();
				nodes = player2Nodes;
				nodes[16 * 1000] = true;
				nodes[21.0 * 1000] = true;
				nodes[24.5 * 1000] = true;
				nodes[25.5 * 1000] = true;
				nodes[27.8 * 1000] = true;
				nodes[33.6 * 1000] = true;
				nodes[34.5 * 1000] = true;
				nodes[37.2 * 1000] = true;
				nodes[39.0 * 1000] = true;
				nodes[41.5 * 1000] = true;
				nodes[43.0 * 1000] = true;
				nodes[44.2 * 1000] = true;
				nodes[45.2 * 1000] = true;
				nodes[47.0 * 1000] = true;
				nodes[49.5 * 1000] = true;
				nodes[53.5 * 1000] = true;
				nodes[55.5 * 1000] = true;
				nodes[58.5 * 1000] = true;
				nodes[59.5 * 1000] = true;
				nodes[61.5 * 1000] = true;
				nodes[62.0 * 1000] = true;
				nodes[64.0 * 1000] = true;
				nodes[65.5 * 1000] = true;

				var player3Nodes = new Object();
				nodes = player3Nodes;
				nodes[15 * 1000] = true;
				nodes[21.0 * 1000] = true;
				nodes[24.5 * 1000] = true;
				nodes[26.5 * 1000] = true;
				nodes[29.0 * 1000] = true;
				nodes[31.0 * 1000] = true;
				nodes[37.5 * 1000] = true;


				var player4Nodes = new Object();
				nodes = player4Nodes;
				nodes[15.0 * 1000] = true;
				nodes[21.0 * 1000] = true;
				nodes[24.0 * 1000] = true;
				nodes[27.5 * 1000] = true;
				nodes[29.5 * 1000] = true;
				nodes[32.0 * 1000] = true;
				nodes[34.5 * 1000] = true;
				nodes[36.5 * 1000] = true;
				nodes[37.5 * 1000] = true;
				nodes[38.5 * 1000] = true;
				nodes[46.5 * 1000] = true;
				nodes[49.0 * 1000] = true;
				nodes[51.0 * 1000] = true;
				nodes[55.5 * 1000] = true;
				nodes[58.5 * 1000] = true;
				nodes[62.0 * 1000] = true;
				nodes[64.5 * 1000] = true;
				nodes[65.5 * 1000] = true;
				nodes[66.5 * 1000] = true;
				nodes[67.0 * 1000] = true;
				nodes[67.2 * 1000] = true;


				this._playerNodes = new Array
				(
					player1Nodes,
					player2Nodes,
					player3Nodes,
					player4Nodes
				);
			};

			Simulation.prototype.getPlayerName = function()
			{
				return "Bot";
			};
			
			Simulation.prototype.clearWatch = function()
			{
				for(var i in this.watches)
				{
					self.clearTimeout(this.watches[i]);
				}
				
				this.watches.splice(0, this.watches.length);
			};

			Simulation.prototype.getCurrentPosition = function(functionName)
			{
				functionName(getPosition(_lastServerPosition[0], _lastServerPosition[1]));
			};

			Simulation.prototype.registerClicks = function()
			{
				var nodes = this._playerNodes[getPlayer().getId() - 1];
				var node;

				for(var seconds in nodes)
				{
					this.watches.push
					(
						self.setTimeout
						(
							function()
							{
								submitPoint();
							},
							parseInt(seconds)
						)
					);
				} 
			};

			function getPosition(lat, lng)
			{
				var wrapper = new Object();
				wrapper.coords = new Object();
				wrapper.coords.latitude = Number(lat);
				wrapper.coords.longitude = Number(lng);
				return wrapper;
			}

			function functionDelegate(functionName, lat, lng)
			{
				var wrapper = getPosition(lat, lng);
				
				functionName.call(self, wrapper);
			}
			
			Simulation.prototype.watchPosition = function(functionName)
			{
				var len = this._playerPositions;
				var positions = this._playerPositions[getPlayer().getId() - 1];
				
				//var position;
				//var wrapper;
				
				for(var seconds in positions)
				{
					this.watches.push
					(
						self.setTimeout
						(
							"functionDelegate(" + functionName + "," + positions[seconds].lat() + "," + positions[seconds].lng() + ");",
							parseInt(seconds)
						)
					);
				}
					
				return this.watches;
			};

			//* End of simulation block

			//use object for associative array - works better
			var _players = new Object();
			_players.length = 0;
			var colors = new Array("#000000", "#FF0000", "#0000FF", "#FFFF00", "#00FF00", "#00FFFF", "#FF00FF");

			var _playerId;

			var _map;
			
			var _location;

			function Line(player)
			{
				this.Player = player;
				this.Partials = new Array();
				this.PolyLine = null;
			};

			Line.prototype.removePartials = function()
			{
				if(!this.Partials)
					return; //already removed
					
				//remove all polylines
				var last;
				while(last = this.Partials.pop())
				{
					last.setMap(null);
				}

				//we no longer need the array
				this.Partials = null;
			};

			Line.prototype.set = function(startLat, startLng, endLat, endLng)
			{
				var start = new google.maps.LatLng(startLat, startLng);
				var end = new google.maps.LatLng(endLat, endLng);
			
				this.PolyLine = new google.maps.Polyline
				(
					{
			       		path:[start, end],
			       		strokeColor: this.Player.Color,
			       		strokeOpacity: 1.0,
			       		strokeWeight: 3
					}
				);
				this.PolyLine.setMap(_map);

				this.removePartials();

				//make sure line is displayed
				fitBounds(start);
				fitBounds(end);
			};

			Line.prototype.setPartial = function(startLat, startLng, endLat, endLng)
			{
				if(!this.isPartial())
					return; //we already have the whole line

				var start = new google.maps.LatLng(startLat, startLng);
				var end = new google.maps.LatLng(endLat, endLng);
					
				var polyline = new google.maps.Polyline
				(
					{
			       		path:[start, end],
			       		strokeColor: this.Player.Color,
			       		strokeOpacity: 1.0,
			       		strokeWeight: 2
			       	}
				);
				polyline.setMap(_map);
				this.Partials.push(polyline);

				//make sure partials are displayed
				fitBounds(start);
				fitBounds(end);
			};

			Line.prototype.isPartial = function()
			{
				return this.PolyLine == null;
			};

			function Player(player_name, player_id)
			{
				this.Name = player_name;
  				this.ID   = player_id;
				this.Color = colors[_players.length];

				this.Lines = new Object();
			};

			Player.prototype.addPartialLine = function(segmentId, startLat, startLng, endLat, endLng)
			{
				var line = this.getLine(segmentId);
				line.setPartial(startLat, startLng, endLat, endLng);
			};

			Player.prototype.addLine = function(segmentId, startLat, startLng, endLat, endLng)
			{
				var line = this.getLine(segmentId);
				line.set(startLat, startLng, endLat, endLng);					
			};

			Player.prototype.getLine = function(segmentId)
			{
				var line = this.Lines[segmentId];

				//no line yet - create new one
				if(!line)
				{
					line = new Line(this);
					this.Lines[segmentId] = line;
				}

				return line;
			};

			Player.prototype.getId = function()
			{
				return this.ID;
			};

			function getPlayerById(id, name)
			{				
				var player = _players[id];

				if(!player)
				{
					if(name)
						player = new Player(name, id);
					else
						player = new Player("unknown", id);
					
					_players[id] = player;
					_players.length++;
				}

				return player;
			}
		
			//save the last servertime of a received update
			var lastServerTime;
			var _marker;
			var _bounds;

			var _watchID;
			
			//var ServerUrl = "http://ron.lcid-fire.org/server.php";
			//var serverUrl = "http://localhost:8080/";
			var serverUrl = document.location.protocol + "//" + document.location.host + "/";
		
			function callRPCMethod(methodName)
			{
				var request = new XmlRpcRequest(serverUrl, "Server." + methodName);
				for(var i = 1; i < arguments.length; i++)
				{
					request.addParam(arguments[i]);
				}

				var response = request.send();

				response.parseXML();

				if(response.isFault())
					return null;
				else
					return response.params;
			}
		
			function updatePosition(position)
			{
				var lat;
				var lng;
				
				if(position.coords)
				{
					lat = position.coords.latitude;
					lng = position.coords.longitude;
				}
				else
				{
					lat = position.latitude;
					lng = position.longitude;
				}

				var myLatLng = new google.maps.LatLng(lat, lng);

				if(_marker)
					_marker.setPosition(myLatLng);
 				else
				{
					_marker = new google.maps.Marker
					({
      						position: myLatLng, 
							map: _map, 
							title: getPlayer().Name + "s Position"
					});
				}

				fitBounds();

				//make sure marker is displayed

				//_map.panTo(myLatLng);
			}
		
			function submitPoint()
			{
				if(!_marker)
					return;

				var response = callRPCMethod("addNode", getPlayer().getId());

				if(!response || !response[0])
					return; //TODO: handle properly

				var segmentArray = response[0];

				if(!segmentArray.length)
					return; //no segment yet
				
				getPlayer().addLine(segmentArray[0], segmentArray[1], segmentArray[2], segmentArray[3], segmentArray[4]);
			}

			function fitBounds(latLng)
			{
				if(latLng)
				{
					if(_bounds)
						_bounds.extend(latLng);
					else
						_bounds = new google.maps.LatLngBounds(latLng, latLng)
				}
			
				var newBounds;

				if(_bounds)
				{
					newBounds = new google.maps.LatLngBounds
					(
						_bounds.getSouthWest(),
						_bounds.getNorthEast()
					);
					newBounds.extend(_marker.getPosition());
				}
				else
					newBounds = new google.maps.LatLngBounds(_marker.getPosition(), _marker.getPosition());
				
				_map.fitBounds(newBounds);
			}

			function callForAll(player, segmentArray)
			{
				for(var index in segmentArray)
				{
					var segmentData = segmentArray[index];

					if(segmentData[0] == "segment")
						player.addLine(segmentData[1], segmentData[2], segmentData[3], segmentData[4], segmentData[5]);
					else
						player.addPartialLine(segmentData[1], segmentData[2], segmentData[3], segmentData[4], segmentData[5]);
					
				}
			}			
		
			function getPoints()
			{
				if(!_marker)
					return; //we cannot do anything without a position
				
				var position = _marker.getPosition();

				var playerId = getPlayer().getId();

				var responseParameters;
				if(lastServerTime)
					responseParameters = callRPCMethod("updateState", playerId, position.lat(), position.lng(), lastServerTime);
				else
					responseParameters = callRPCMethod("updateState", playerId, position.lat(), position.lng());

				if(!responseParameters || !responseParameters.length)
					return; //TODO: problem handling

				_lastServerPosition[0] = position.lat(); 
				_lastServerPosition[1] = position.lng();

				var stateMap = responseParameters[0];
				
				if(stateMap["won"])
				{
					setUpdate(false);
					alert("YOU HAVE WON!");
					return;
				}

				lastServerTime = stateMap["time"];

				var playerData = stateMap["data"];
				var player;
							
				//process all received player data
				for(var playerId in playerData)
				{
					player = getPlayerById(playerId);

					//process whole segments
					callForAll(player, playerData[playerId]);
				}
			}

			function getPlayer()
			{
				if(!_playerId)
					return null;

				return _players[_playerId];
			}
		
			function addPlayer(playerName, lat, lng)
			{
				if(getPlayer())
				{
					alert("Multiple players not supported by one client");
					return false;
				}
					
				var parameter = callRPCMethod("addPlayer", playerName, lat, lng);

				if(!parameter || parameter.length == 0)
					return false;
		
				if(!parameter[0])
					return false; //something unexpected went wrong
				
				var	playerId = parseInt(parameter[0]);

				getPlayerById(playerId, playerName);

				//save id of first player
				if(!_playerId)
					_playerId = playerId;

				return true;
			}
		
			function removePlayer()
			{
				if(!getPlayer())
					return; //we don't have logged in player
				
				callRPCMethod("removePlayer", getPlayer().getId());

				for(var id in _players)
				{
					_players[id] = null;
				}
			}

			function login()
			{
				if(true)
					_location = new Simulation();
				else if(navigator.geolocation)
					_location = navigator.geolocation;
				else
				{
					var script = document.createElement("script");
					script.setAttribute("type", "text/javascript");
					script.setAttribute("src", "http://code.google.com/apis/gears/gears_init.js");
					document.getElementsByTagName("head")[0].appendChild(script);
					_location = google.gears.factory.create('beta.geolocation');
				}

				if(!_location.getPlayerName)
					_location.getPlayerName = function()
					{
						return prompt("Please enter your player's name", "");
					};
				
				_location.getCurrentPosition
				(
					function(position)
					{
						var playerName = _location.getPlayerName();
						
						if(playerName == null)
							return;

						var coords;
						
						if(position.coords)
							coords = position.coords;
						else
							coords = position;

						if(!addPlayer(playerName, coords.latitude, coords.longitude))
						{
							alert("Login failed");
							return;
						}

						//position data was sent when created player
						_lastServerPosition[0] = coords.latitude;
						_lastServerPosition[1] = coords.longitude;

						var myLatLng = new google.maps.LatLng(coords.latitude, coords.longitude);
					
						var myOptions =
						{
							disableDefaultUI: true,
							disableDoubleClickZoom: true,
							keyboardShortcuts: false,
							scrollwheel: false,
							mapTypeControl: false,
							zoom: 10,
							center: myLatLng,
							mapTypeId: google.maps.MapTypeId.ROADMAP
						};
			
						_map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);					
						
						updatePosition(position);

						setUpdate(true);

						if(_location.registerClicks)
							_location.registerClicks();

						//not working for some awkward reason
						//google.maps.event.addListener(_map, 'click', submitPoint);
						document.onclick = submitPoint;
					}
				);  
			}
			
			function setUpdate(bvalue)
			{
				if(bvalue)
				{
					//be aware that delegation does not work in java
					//as in other programming languages - therefor
					//we need to call the function on their objects
					//to have the correct context 
					
					_watchID = _location.watchPosition(updatePosition);
				
					//refresh the points every second
					window.setInterval("getPoints()", 1000);
				}
				else
				{
					window.clearInterval("getPoints()");
					
					if(_watchID && _location)
						_location.clearWatch(_watchID);
				}
			}
		
			function logout()
			{
			
				setUpdate(false);
				
				removePlayer();
			}
			
		</script>
		<meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
		<style type="text/css">
			html, body, body div { width:100%; height:100%; padding:0px; margin:0px}
		</style>
	</head>
	<body onload="login()" onunload="logout()">
		<div id="map_canvas"></div>
	</body>
</html>

